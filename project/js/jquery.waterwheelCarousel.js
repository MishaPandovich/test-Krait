!function(s){"use strict";s.fn.waterwheelCarousel=function(t){if(1<this.length)return this.each(function(){s(this).waterwheelCarousel(t)}),this;var r=this,p={},v={};function i(t){clearTimeout(v.autoPlayTimer),t||0===p.autoPlay||(v.autoPlayTimer=setTimeout(function(){0<p.autoPlay?e("forward"):e("backward")},Math.abs(p.autoPlay)))}function o(t,e){Math.abs(e)<=p.flankingItems+1?(!function(t,e){var i=Math.abs(e);if(i<p.flankingItems+1)var a=v.calculations[i];else a=v.calculations[p.flankingItems+1];var n,r=Math.pow(p.sizeMultiplier,i),o=r*t.data("original_width"),s=r*t.data("original_height"),c=Math.abs(t.width()-o),l=Math.abs(t.height()-s),h=a.offset,d=a.distance;if(e<0&&(d*=-1),"horizontal"==p.orientation)var u=(f=v.containerWidth/2)+d-o/2,m=p.horizon-h-s/2;else{var f=v.containerHeight/2;u=p.horizon-h-o/2,m=f+d-s/2}m-=l/2,u-=c/2,n=0===e?1:a.opacity;var g=p.flankingItems+2-i;t.data("width",o),t.data("height",s),t.data("top",m),t.data("left",u),t.data("oldPosition",t.data("currentPosition")),t.data("depth",g),t.data("opacity",n),t.data("distanceFactor",r)}(t,e),v.itemsAnimating++,t.css("z-index",t.data().depth).animate({left:t.data().left,top:t.data().top,opacity:t.data().opacity},v.currentSpeed,p.animationEasing,function(){!function(t,e){v.itemsAnimating--,t.data("currentPosition",e),0===e&&(v.currentCenterItem=t);0===v.itemsAnimating&&(v.carouselRotationsLeft-=1,v.currentlyMoving=!1,0<v.carouselRotationsLeft?a(0):(v.currentSpeed=p.speed,v.currentCenterItem.addClass(p.activeClassName),!1===v.performingSetup&&(p.movedToCenter(v.currentCenterItem),p.movedFromCenter(v.previousCenterItem)),v.performingSetup=!1,i()))}(t,e)}),TweenMax.to(t,v.currentSpeed/1e3,{scaleX:t.data("distanceFactor"),scaleY:t.data("distanceFactor"),ease:p.animationEasing})):(t.data("currentPosition",e),0===t.data("oldPosition")&&(t.css({left:t.data().left,top:t.data().top,opacity:t.data().opacity,"z-index":t.data().depth}),TweenMax.to(t,0,{scaleX:t.data("distanceFactor"),scaleY:t.data("distanceFactor")})))}function a(t){if(!1===v.currentlyMoving){v.currentCenterItem.removeClass(p.activeClassName),v.currentlyMoving=!0,v.itemsAnimating=0,v.carouselRotationsLeft+=t,!0===p.quickerForFurther&&(1<t&&(v.currentSpeed=p.speed/t),v.currentSpeed=v.currentSpeed<100?100:v.currentSpeed);for(var e=0;e<v.totalItems;e++){var i,a=s(v.items[e]),n=a.data("currentPosition"),r=0<(i="forward"==v.currentDirection?n-1:n+1)?v.rightItemsCount:v.leftItemsCount;Math.abs(i)>r&&(i=-1*n,v.totalItems%2==0&&(i+=1)),o(a,i)}}}function e(t){var e,i;!1===v.currentlyMoving&&(v.previousCenterItem=v.currentCenterItem,p.movingFromCenter(v.currentCenterItem),"backward"==t?(p.movingToCenter(((i=v.currentCenterItem.prev()).length<=0&&(i=v.currentCenterItem.parent().children().last()),i)),v.currentDirection="backward"):"forward"==t&&(p.movingToCenter(((e=v.currentCenterItem.next()).length<=0&&(e=v.currentCenterItem.parent().children().first()),e)),v.currentDirection="forward")),a(1)}return s(this).children().bind("click",function(){var t=s(this).data().currentPosition;if(0!=p.imageNav&&!(Math.abs(t)>=p.flankingItems+1||v.currentlyMoving)){v.previousCenterItem=v.currentCenterItem,i(!0),p.autoPlay=0;var e=Math.abs(t);0==t?p.clickedCenter(s(this)):(p.movingFromCenter(v.currentCenterItem),p.movingToCenter(s(this)),t<0?(v.currentDirection="backward",a(e)):0<t&&(v.currentDirection="forward",a(e)))}}),s(document).keydown(function(t){if(p.keyboardNav&&(37===t.which&&"horizontal"==p.orientation||38===t.which&&"vertical"==p.orientation?(i(!0),p.autoPlay=0,e("backward")):(39===t.which&&"horizontal"==p.orientation||40===t.which&&"vertical"==p.orientation)&&(i(!0),p.autoPlay=0,e("forward")),p.keyboardNavOverride&&("horizontal"==p.orientation&&(37===t.which||39===t.which)||"vertical"==p.orientation&&(38===t.which||40===t.which))))return t.preventDefault(),!1}),this.reload=function(t){if("object"==typeof t);else;var e,i,a,n;p=s.extend({},s.fn.waterwheelCarousel.defaults,t),(v={itemsContainer:s(r),totalItems:s(r).children().length,containerWidth:s(r).width(),containerHeight:s(r).height(),currentCenterItem:null,previousCenterItem:null,items:[],calculations:[],carouselRotationsLeft:0,currentlyMoving:!1,itemsAnimating:0,currentSpeed:p.speed,intervalTimer:null,currentDirection:"forward",leftItemsCount:0,rightItemsCount:0,performingSetup:!0}).itemsContainer.children().removeClass(p.activeClassName),v.itemsContainer.children().hide(),p.forcedImageWidth&&p.forcedImageHeight&&v.itemsContainer.children().each(function(){s(this).width(p.forcedImageWidth),s(this).height(p.forcedImageHeight)}),e=function(){v.itemsContainer.children().each(function(){(null==s(this).data("original_width")||0<p.forcedImageWidth)&&s(this).data("original_width",s(this).width()),(null==s(this).data("original_height")||0<p.forcedImageHeight)&&s(this).data("original_height",s(this).height())}),function(){v.itemsContainer.children().eq(0),v.calculations[0]={distance:0,offset:0,opacity:1};for(var t=p.horizonOffset,e=p.separation,i=1;i<=p.flankingItems+2;i++)1<i&&(t*=p.horizonOffsetMultiplier,e*=p.separationMultiplier),v.calculations[i]={distance:v.calculations[i-1].distance+e,offset:v.calculations[i-1].offset+t,opacity:v.calculations[i-1].opacity*p.opacityMultiplier};p.edgeFadeEnabled?v.calculations[p.flankingItems+1].opacity=0:v.calculations[p.flankingItems+1]={distance:0,offset:0,opacity:0}}(),function(){v.items=v.itemsContainer.children();for(var t=0;t<v.totalItems;t++)v.items[t]=s(v.items[t]);0===p.horizon&&("horizontal"===p.orientation?p.horizon=v.containerHeight/2:p.horizon=v.containerWidth/2),v.itemsContainer.css("position","relative").children().each(function(){var t,e;e="horizontal"===p.orientation?(t=v.containerWidth/2-s(this).data("original_width")/2,p.horizon-s(this).data("original_height")/2):(t=p.horizon-s(this).data("original_width")/2,v.containerHeight/2-s(this).data("original_height")/2),s(this).css({left:t,top:e,visibility:"visible",position:"absolute","z-index":0,opacity:0}).data({top:e,left:t,oldPosition:0,currentPosition:0,depth:0,opacity:0}).show()})}(),function(){p.startingItem=0===p.startingItem?Math.round(v.totalItems/2):p.startingItem,v.rightItemsCount=Math.ceil((v.totalItems-1)/2),v.leftItemsCount=Math.floor((v.totalItems-1)/2),v.carouselRotationsLeft=1,o(v.items[p.startingItem-1],0),v.items[p.startingItem-1].css("opacity",1);for(var t=p.startingItem-1,e=1;e<=v.rightItemsCount;e++)t<v.totalItems-1?t+=1:t=0,v.items[t].css("opacity",1),o(v.items[t],e);for(t=p.startingItem-1,e=-1;e>=-1*v.leftItemsCount;e--)0<t?t-=1:t=v.totalItems-1,v.items[t].css("opacity",1),o(v.items[t],e)}()},i=v.itemsContainer.find("img"),a=i.length,n=0,!1!==p.preloadImages&&0!==i.length?i.each(function(){s(this).bind("load",function(){(n+=1)!==a||e()}),s(this).attr("src",s(this).attr("src")),this.complete&&s(this).trigger("load")}):e()},this.next=function(){i(!0),p.autoPlay=0,e("forward")},this.prev=function(){i(!0),p.autoPlay=0,e("backward")},this.reload(t),this},s.fn.waterwheelCarousel.defaults={startingItem:1,separation:175,separationMultiplier:.6,horizonOffset:0,horizonOffsetMultiplier:1,sizeMultiplier:.7,opacityMultiplier:.8,horizon:0,flankingItems:3,speed:300,animationEasing:"linear",quickerForFurther:!0,edgeFadeEnabled:!1,linkHandling:2,autoPlay:0,orientation:"horizontal",activeClassName:"carousel-center",keyboardNav:!1,keyboardNavOverride:!0,imageNav:!0,preloadImages:!0,forcedImageWidth:0,forcedImageHeight:0,movingToCenter:s.noop,movedToCenter:s.noop,clickedCenter:s.noop,movingFromCenter:s.noop,movedFromCenter:s.noop}}(jQuery);